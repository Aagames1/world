<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Puzzle World</title>
<style>
body {
  background: black;
  color: #00ffcc;
  font-family: monospace;
  padding: 20px;
  white-space: pre-wrap;
}
input, button {
  background: black;
  color: #00ffcc;
  font-family: monospace;
  border: 1px solid #00ffcc;
  padding: 2px 6px;
  margin: 2px;
}
button:hover { background: #00ffcc; color: black; cursor: pointer; }
.error {
  color: #ff4444;
  border: 2px solid #ff4444;
  padding: 10px;
  font-weight: bold;
}
.ascii { color: #66ffcc; }
</style>
</head>
<body>

<pre id="game"></pre>

<input type="text" id="pathInput" placeholder="/start">
<button id="goBtn">GO</button>

<script>
let inventory = [];
let rockHidden = false;
let sqlBypassUsed = false;
let passwordFound = false;
let adminAccess = false;

// Locations
const locations = {
"/start": `
╔═══════════╗
║  PUZZLE   ║
║  WORLD    ║
╚═══════════╝

You are at the edge of something unfinished.
There’s a path to /home.
`,

"/home": `
╔═══════════╗
║  HOME     ║
╚═══════════╝

You wake up in your house.
Through the front door, there’s a /outside.
`,

"/home/outside": `
╔═══════════╗
║  OUTSIDE  ║
╚═══════════╝

You step outside.
To your left, there’s a /farm.
To your right, a dark /cave looms.
`,

"/home/outside/farm": `
╔═══════════╗
║  FARM     ║
╚═══════════╝

You arrive at the farm.
A small /hut is nearby.
Crops stretch into a /field.
`,

"/home/outside/farm/hut": `
╔═══════════╗
║  HUT      ║
╚═══════════╝

Inside the hut, dust floats in beams of light.
Behind a plank, there’s a hidden /vault.
`,

"/home/outside/farm/hut/vault": `
╔═══════════╗
║  VAULT    ║
╚═══════════╝

A heavy metal vault with a 5-letter code lock.
Type the code in the hash: #/home/outside/farm/hut/vault/CORNY
`,

"/home/outside/farm/hut/vault/CORNY": `
╔═══════════╗
║ VAULT OPEN║
╚═══════════╝

You entered CORNY. The vault swings open.
Inside, you find a FLASHLIGHT.
A note says: "You'll need it in the /cave."
`,

"/home/outside/farm/field": `
╔═══════════╗
║  FIELD    ║
╚═══════════╝

The crops sway in the breeze.
Near the edge, an old /tractor sits.
`,

"/home/outside/farm/field/tractor": `
╔═══════════╗
║  TRACTOR  ║
╚═══════════╝

The tractor is broken, but under the seat is a note: CORNY
`,

"/home/outside/cave": `
╔═══════════╗
║  CAVE     ║
╚═══════════╝

The cave is dark.
You need a /flashlight to enter.
`,

"/home/outside/cave/flashlight": `
╔═══════════╗
║  CAVE     ║
╚═══════════╝

You turn on your flashlight.
A narrow /path continues deeper inside.
`,

"/home/outside/cave/flashlight/path": `
╔═══════════╗
║  PATH     ║
╚═══════════╝

The path is tight and rocky.
A huge boulder blocks the way.
Something beyond: /beyond
`,

"/home/outside/cave/flashlight/path/beyond": `
╔═══════════╗
║  CLEARING ║
╚═══════════╝

The boulder is gone.
In the clearing, there’s a /terminal.
`,

"/home/outside/cave/flashlight/path/beyond/terminal": `
╔═══════════╗
║ TERMINAL  ║
╚═══════════╝

The terminal hums softly.
The main door leads to /mainframe.
`,

"/home/outside/cave/flashlight/path/beyond/terminal/mainframe": `
╔══════════════╗
║ MAINFRAME    ║
╚══════════════╝

Locked. Password hidden as "ECHO42".
Type hash: #/home/outside/cave/flashlight/path/beyond/terminal/mainframe/ECHO42
`,

"/home/outside/cave/flashlight/path/beyond/terminal/mainframe/ECHO42": `
╔══════════════╗
║ ACCESS GRANTED║
╚══════════════╝

You unlocked the mainframe.
There’s a /files section and a /settings section to explore.
`,

"/restart": `
╔═══════════╗
║ RESTART   ║
╚═══════════╝

Game reset. Go to #/start to play again.
`
};

// Get current path
function getPath() {
  let path = location.hash.replace("#", "") || "/start";
  // allow #/start/home
  if (path.startsWith("/start/")) path = path.replace("/start", "");
  if (path === "") path = "/home";
  return path;
}

// Resolve existing path
function resolve(path) {
  const parts = path.split("/").filter(Boolean);
  for (let i = parts.length; i >= 0; i--) {
    const candidate = "/" + parts.slice(0, i).join("/");
    if (locations[candidate]) return candidate;
  }
  return null;
}

function render() {
  const path = getPath();
  const game = document.getElementById("game");
  const resolved = resolve(path);

  if (!resolved) {
    game.innerHTML = `
╔════════════════════════════════╗
║         WRONG PATH!            ║
╚════════════════════════════════╝

The path "${path}" does not exist.

Try valid paths like /home or /home/outside/farm.
    `;
    game.classList.add("error");
    return;
  }

  // Flashlight requirement
  if (resolved.includes("/cave/flashlight") && !inventory.includes("flashlight")) {
    game.innerHTML = `
╔════════════════════╗
║  ACCESS DENIED     ║
╚════════════════════╝

You need a FLASHLIGHT to enter this cave!
Return to /home/outside/farm/hut to find one.
    `;
    game.classList.add("error");
    return;
  }

  game.textContent = locations[resolved];
  game.classList.remove("error");

  // Auto-give flashlight if visiting vault
  if (resolved === "/home/outside/farm/hut/vault/CORNY" && !inventory.includes("flashlight")) {
    inventory.push("flashlight");
  }
}

// Handle hash input
document.getElementById("goBtn").addEventListener("click", () => {
  let val = document.getElementById("pathInput").value.trim();
  if (!val.startsWith("/")) val = "/" + val;
  location.hash = val;
});
document.getElementById("pathInput").addEventListener("keypress", (e) => {
  if (e.key === "Enter") document.getElementById("goBtn").click();
});

window.addEventListener("hashchange", render);
if (!location.hash) location.hash = "#/start";
render();
</script>
</body>
</html>
