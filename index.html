<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Puzzle World</title>

<style>
body {
  background: black;
  color: #16a34a;
  font-family: monospace;
  margin: 0;
  padding: 20px;
}
.panel {
  border: 1px solid #16a34a;
  padding: 16px;
}
.notice {
  color: #a7f3d0;
}
pre {
  white-space: pre-wrap;
  margin: 0;
}
</style>
</head>
<body>

<div id="app"></div>

<script>
/* ---------- ROUTING ---------- */
if (!location.hash) location.hash = "#/home";
const path = () => location.hash.slice(1) || "/home";

/* ---------- GAME STATE (minimal) ---------- */
let boulderCleared = false;

/* ---------- LOCATIONS ---------- */
const locations = {

"/home": `
   [ HOME ]
   _______
  |       |
  |  BED  |
  |_______|

You wake up alone.
No sound. No movement.

A path leads /outside
`,

"/home/outside": `
   [ OUTSIDE ]
     â˜   â˜
   ğŸŒ²       ğŸŒ²

Cold air.
The world feels abandoned.

There is a /farm nearby.
A darker trail leads into a /cave.
`,

"/home/outside/farm": `
   [ FARM ]
   ğŸŒ¾ğŸŒ¾ğŸŒ¾
   ğŸŒ¾ğŸŒ¾ğŸŒ¾

The crops still grow.

You notice a /hut.
Beyond it, an open /field.
`,

"/home/outside/farm/field": `
   [ FIELD ]
   ğŸŒ½ğŸŒ½ğŸŒ½

A rusted /tractor sits quietly.
`,

"/home/outside/farm/field/tractor": `
   [ TRACTOR ]

A note stuck under the seat reads:

"What did the crop say to the other crop?
Stop being CORNY."
`,

"/home/outside/farm/hut": `
   [ HUT ]
    _____
   |_____|

Dust coats the floor.

A sealed /vault rests in the corner.
`,

"/home/outside/farm/hut/vault": `
   [ VAULT ]
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

A 5-letter lock.
`,

"/home/outside/farm/hut/vault/CORNY": `
   [ VAULT OPEN ]

Inside:
medical supplies
a small flashlight

"/FLASHLIGHT obtained.
This could be useful somewhere else."
`,

"/home/outside/cave": `
   [ CAVE ]
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

Darkness swallows the entrance.

You feel like going further might require
something you don't yet have.
`,

"/home/outside/cave/flashlight": `
   [ CAVE â€” LIT ]
   â–ˆ  ğŸ”¦  â–ˆ

Light reveals branching tunnels.

There's a /wall here,
a deep /hole,
and a narrow /path ahead.
`,

"/home/outside/cave/flashlight/path": {
  text: `
   [ NARROW PATH ]
   â–ˆâ–ˆâ–ˆâ›”â–ˆâ–ˆâ–ˆâ–ˆ

A massive boulder blocks the way.

Scratched faintly into the stone:
"inspect"
`,
  boulder: true
},

"/home/outside/cave/flashlight/path/thewayforward": `
   [ BEYOND ]
    â–ˆ   â–ˆ

The boulder is gone.

A warning sign reads:
"YOU WERE WARNED"

You may /continue
`,

"/home/outside/cave/flashlight/path/thewayforward/continue": `
   [ TERMINAL ]
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ACCESS   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

A dusty terminal hums to life.

> LOGIN REQUIRED
`,

"/home/outside/cave/flashlight/path/thewayforward/continue/admin": `
ACCESS DENIED

Session data appears client-controlled.
`,

"/home/outside/cave/flashlight/path/thewayforward/continue/root": `
   [ CORE ]

The system unlocks.

Logs scroll endlessly.
The world was automated.
Then abandoned.

You were not meant to find this.

But you did.

> END
`
};

/* ---------- RENDER ---------- */
function render() {
  const app = document.getElementById("app");
  app.innerHTML = "";

  const panel = document.createElement("div");
  panel.className = "panel";

  const loc = locations[path()];

  if (!loc) {
    panel.innerHTML = `
<pre>
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ WRONG PATH   â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

"${path()}" does not exist.
</pre>`;
    app.appendChild(panel);
    return;
  }

  if (typeof loc === "string") {
    panel.innerHTML = `<pre>${loc}</pre>`;
  } else {
    panel.innerHTML = `<pre>${loc.text}</pre>`;

    if (loc.boulder && !boulderCleared) {
      const rock = document.createElement("pre");
      rock.id = "boulder";
      rock.textContent = `
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ`;
      panel.appendChild(rock);
    }

    if (loc.boulder && boulderCleared) {
      panel.innerHTML += `
<pre>
The obstruction is gone.

You notice faint text ahead:
/thewayforward
</pre>`;
    }
  }

  app.appendChild(panel);
}

/* ---------- BOULDER INSPECT PUZZLE ---------- */
new MutationObserver(() => {
  if (
    path().endsWith("/path") &&
    document.getElementById("boulder") === null &&
    !boulderCleared
  ) {
    boulderCleared = true;

    const note = document.createElement("pre");
    note.className = "notice";
    note.textContent = `
The rock has vanished.

Something was hidden beyond it.
/thewayforward
`;
    document.querySelector(".panel").appendChild(note);
  }
}).observe(document.body, { childList: true, subtree: true });

/* ---------- TERMINAL COOKIE PUZZLE ---------- */
window.addEventListener("hashchange", () => {
  if (path().endsWith("/admin")) {
    if (document.cookie.includes("user=admin")) {
      location.hash =
        "#/home/outside/cave/flashlight/path/thewayforward/continue/root";
    }
  }
  render();
});

render();
</script>

</body>
</html>
