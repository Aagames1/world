<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Puzzle World</title>
  <style>
    body {
      background: black;
      color: #00ffcc;
      font-family: monospace;
      padding: 20px;
      white-space: pre-wrap;
    }
    .error {
      color: red;
      font-weight: bold;
    }
    .boulder {
      border: 2px solid gray;
      padding: 10px;
      text-align: center;
      margin: 10px 0;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>

<div id="game"></div>

<script>
const inventory = [];
let boulderRemoved = false;

const paths = {
  "/": {
    text: `
WELCOME TO PUZZLE WORLD

A mysterious puzzle adventure awaits.
Change the URL path to /home to begin your journey.`
  },
  "/home": {
    text: `
You are in your empty home.

There's a /outside you can explore.`
  },
  "/home/outside": {
    text: `
You step outside.

To your left, there's a /farm.
To your right, a dark /cave looms.`
  },
  "/home/outside/farm": {
    text: `
        _.-^~~~^-._
     .-'      ğŸŒ¾      '-.
  .-'      ğŸŒ¾     ğŸŒ¾       '-.
 /    ğŸŒ¾        |         ğŸŒ¾     \\
|              |                |
|     FARM     |     FARM       |
|______________|________________|
   ||      ||        ||      ||
   ||      ||        ||      ||

The farm is quiet.

There's a /field stretching forward,
and a small /barn off to the side.`
  },
  "/home/outside/farm/field": {
    text: `
      ğŸŒ¾   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾
   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾
      ğŸŒ¾   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾   ğŸŒ¾

You see an abandoned /tractor.`
  },
  "/home/outside/farm/field/tractor": {
    text: `
The tractor is broken.

A sticky note reads:

"Stop being CORNY!"  

Perhaps this is the 5-letter code for the vault.`
  },
  "/home/outside/farm/barn": {
    text: `
        _________
       /_______/|
      |   BARN | |
      |        | |
      |________|/

Inside, you see a small /hut.`
  },
  "/home/outside/farm/hut": {
    text: `
The hut is mostly empty.

Against the back wall is a locked /vault.`
  },
  "/home/outside/farm/hut/vault": {
    text: `
  _______
 /       \\
|  VAULT  |
|  LOCKED |
 \\_______/

Enter the 5-letter code using the URL:

/home/outside/farm/hut/vault/CORNY`
  },
  "/home/outside/farm/hut/vault/CORNY": {
    text: `
â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“
ACCESS GRANTED
â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“

Inside the vault you find:
- A FLASHLIGHT [added to inventory]
- A crumpled note: <!-- password is ECHO42 -->

Now head to the /cave.`
  },
  "/home/outside/cave": {
    text: `
You reach the cave entrance.

A massive boulder blocks the path.

Use browser DevTools (Inspect Element) to remove it.

Hint: Once removed, a hidden path /beyond will appear.
`,
    requiresItem: "flashlight",
    hasBoulder: true
  },
  "/home/outside/cave/beyond": {
    text: `
You have removed the boulder and entered the cave.

The passage is narrow and winding. Ahead, you see a mysterious /facility.`
  },
  "/home/outside/cave/beyond/facility": {
    text: `
You arrive at the facility entrance.

A locked terminal blocks the way.  
Hint: This page is vulnerable to SQL Injection.  

Try: admin' OR '1'='1 to bypass.
`
  }
};

function render() {
  let path = window.location.hash.replace("#", "") || "/";
  const game = document.getElementById("game");

  // Check flashlight requirement
  const loc = paths[path];
  if (!loc) {
    game.innerHTML = `<div class="error">
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ WRONG PATH   â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

"${path}" does not exist.
</div>`;
    return;
  }
  if (loc.requiresItem && !inventory.includes(loc.requiresItem)) {
    game.innerHTML = `<div class="error">
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ ACCESS DENIED â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

You need a ${loc.requiresItem.toUpperCase()} to proceed.
</div>`;
    return;
  }

  let content = loc.text;

  // Show boulder if present
  if (loc.hasBoulder && !boulderRemoved) {
    content += `\n\n<div class="boulder" id="boulder">
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆ  BOULDER  â–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
</div>`;
  }

  game.innerHTML = content;
}

window.addEventListener("hashchange", render);

// Initial render
render();

// Handle simulated boulder removal via click (for testing)
document.addEventListener("click", e => {
  if (e.target.id === "boulder") {
    boulderRemoved = true;
    // automatically add /beyond path revealed
    window.location.hash = "#/home/outside/cave/beyond";
    render();
  }
});
</script>

</body>
</html>
